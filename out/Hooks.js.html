<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>Hooks.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    
    <h2><a href="index.html">Home</a></h2><h3>Namespaces</h3><ul><li><a href="API.html">API</a><ul class='methods'><li data-type='method'><a href="API.html#.checkNull">checkNull</a></li><li data-type='method'><a href="API.html#.compareTimestampWithCurrentTime">compareTimestampWithCurrentTime</a></li><li data-type='method'><a href="API.html#.convertFirestoreTimestampToDate">convertFirestoreTimestampToDate</a></li><li data-type='method'><a href="API.html#.deg2rad">deg2rad</a></li><li data-type='method'><a href="API.html#.formatCurrency">formatCurrency</a></li><li data-type='method'><a href="API.html#.getBrightness">getBrightness</a></li><li data-type='method'><a href="API.html#.getCurrentTime">getCurrentTime</a></li><li data-type='method'><a href="API.html#.getDisplayAge">getDisplayAge</a></li><li data-type='method'><a href="API.html#.getDisplayName">getDisplayName</a></li><li data-type='method'><a href="API.html#.getSatuation">getSatuation</a></li><li data-type='method'><a href="API.html#.isAdult">isAdult</a></li><li data-type='method'><a href="API.html#.setData">setData</a></li></ul></li><li><a href="Auth.html">Auth</a><ul class='methods'><li data-type='method'><a href="Auth.html#.logout">logout</a></li><li data-type='method'><a href="Auth.html#.signInGoogle">signInGoogle</a></li><li data-type='method'><a href="Auth.html#.signInPassword">signInPassword</a></li><li data-type='method'><a href="Auth.html#.signUpPassword">signUpPassword</a></li></ul></li><li><a href="DB.html">DB</a><ul class='methods'><li data-type='method'><a href="DB.html#.arrange_distance">arrange_distance</a></li><li data-type='method'><a href="DB.html#.arrange_distance">arrange_distance</a></li><li data-type='method'><a href="DB.html#.db_add">db_add</a></li><li data-type='method'><a href="DB.html#.db_delete">db_delete</a></li><li data-type='method'><a href="DB.html#.db_set">db_set</a></li><li data-type='method'><a href="DB.html#.db_update">db_update</a></li><li data-type='method'><a href="DB.html#.get_doc_all">get_doc_all</a></li><li data-type='method'><a href="DB.html#.get_doc_data">get_doc_data</a></li><li data-type='method'><a href="DB.html#.get_doc_list">get_doc_list</a></li><li data-type='method'><a href="DB.html#.upload_image">upload_image</a></li></ul></li><li><a href="Hooks.html">Hooks</a><ul class='methods'><li data-type='method'><a href="Hooks.html#.useAuthState">useAuthState</a></li><li data-type='method'><a href="Hooks.html#.useFirestoreQuery">useFirestoreQuery</a></li><li data-type='method'><a href="Hooks.html#.useLocalStorage">useLocalStorage</a></li></ul></li><li><a href="Matching.html">Matching</a><ul class='methods'><li data-type='method'><a href="Matching.html#.matching_add">matching_add</a></li><li data-type='method'><a href="Matching.html#.matching_get_item">matching_get_item</a></li><li data-type='method'><a href="Matching.html#.matching_get_item">matching_get_item</a></li><li data-type='method'><a href="Matching.html#.matching_get_list">matching_get_list</a></li><li data-type='method'><a href="Matching.html#.matching_set">matching_set</a></li></ul></li><li><a href="User.html">User</a><ul class='methods'><li data-type='method'><a href="User.html#.add_food_tag">add_food_tag</a></li><li data-type='method'><a href="User.html#.add_place_tag">add_place_tag</a></li><li data-type='method'><a href="User.html#.calculateDistance">calculateDistance</a></li><li data-type='method'><a href="User.html#.check_password_valid">check_password_valid</a></li><li data-type='method'><a href="User.html#.compare_password">compare_password</a></li><li data-type='method'><a href="User.html#.del_tag">del_tag</a></li><li data-type='method'><a href="User.html#.display_age_range">display_age_range</a></li><li data-type='method'><a href="User.html#.get_avg_user_score">get_avg_user_score</a></li><li data-type='method'><a href="User.html#.get_page_num">get_page_num</a></li><li data-type='method'><a href="User.html#.get_update_location">get_update_location</a></li><li data-type='method'><a href="User.html#.step1_confirm_blank">step1_confirm_blank</a></li><li data-type='method'><a href="User.html#.step2_confirm_blank">step2_confirm_blank</a></li></ul></li></ul>
    
</nav>

<div id="main">
    
    <h1 class="page-title">Hooks.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { useEffect, useState, useRef, useCallback } from "react";

/**
 * @namespace Hooks
 */

/** 데이터 쿼리
 * @function useFirestoreQuery
 * @memberof Hooks
 * @param {Query&lt;DocumentData, DocumentData>} query 쿼리
 * @return {Array} 조회된 문서들
 */
export function useFirestoreQuery(query) {
  const [docs, setDocs] = useState([]);

  // Store current query in ref
  const queryRef = useRef(query);

  // Compare current query with the previous one
  useEffect(() => {
    // Use Firestore built-in 'isEqual' method
    // to compare queries
    if (!queryRef?.curent?.isEqual(query)) {
      queryRef.current = query;
    }
  });

  // Re-run data listener only if query has changed
  useEffect(() => {
    if (!queryRef.current) {
      return null;
    }

    // Subscribe to query with onSnapshot
    const unsubscribe = queryRef.current.onSnapshot((querySnapshot) => {
      // Get all documents from collection - with IDs
      const data = querySnapshot.docs.map((doc) => ({
        ...doc.data(),
        doc_id: doc.id,
      }));
      // Update state
      setDocs(data);
    });

    // Detach listener
    return unsubscribe;
  }, [queryRef]);

  return docs;
}

/** 인증 정보
 * @function useAuthState
 * @memberof Hooks
 * @param {Auth} auth 인증 정보
 * @return {object} 유저 정보, 인증 상태
 */
export function useAuthState(auth) {
  const [initializing, setInitializing] = useState(true);
  const [user, setUser] = useState(() => auth.currentUser);

  useEffect(() => {
    const unsubscribe = auth.onAuthStateChanged((user) => {
      if (user) {
        setUser(user);
      } else {
        setUser(false);
      }
      if (initializing) {
        setInitializing(false);
      }
    });

    // Cleanup subscription
    return unsubscribe;
  }, [auth, initializing]);

  return { user, initializing };
}

/** 로컬 메모리 저장
 * @function useLocalStorage
 * @memberof Hooks
 * @param {string} key 키
 * @param {string} initialValue 값
 * @return { string } 저장된 값 반환
 */
export function useLocalStorage(key, initialValue) {
  // State to store our value
  // Pass initial state function to useState so logic is only executed once
  const [storedValue, setStoredValue] = useState(() => {
    try {
      // Get from local storage by key
      const item = window.localStorage.getItem(key);
      // Parse stored json or if none return initialValue
      return item ? JSON.parse(item) : initialValue;
    } catch (error) {
      // If error also return initialValue
      console.log(error);
      return initialValue;
    }
  });

  // Return a wrapped version of useState's setter function that ...
  // ... persists the new value to localStorage.
  const setValue = (value) => {
    try {
      // Allow value to be a function so we have same API as useState
      const valueToStore =
        value instanceof Function ? value(storedValue) : value;
      // Save state
      setStoredValue(valueToStore);
      // Save to local storage
      window.localStorage.setItem(key, JSON.stringify(valueToStore));
    } catch (error) {
      // A more advanced implementation would handle the error case
      console.log(error);
    }
  };

  return [storedValue, setValue];
}
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.2</a> on Sat Jan 27 2024 11:45:31 GMT+0900 (GMT+09:00) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>
